namespace = crisis
event = {
    id = crisis.240
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        any_country = {
            has_global_flag = ongoing_prethoryn_invasion
            is_country_type = swarm
            num_armies < 140
        }
    }
    immediate = {
        random_country = {
            limit = {
                is_country_type = swarm
            }
            save_event_target_as = prethoryn
            owner_species = {
                save_event_target_as = prethoryn_species
            }
            random_owned_planet = {
                limit = {
                    is_planet_class = pc_infested
                }
                create_fleet = {
                    name = "NAME_Prethoryn_Armies"
                    effect = {
                        set_owner = event_target:prethoryn
                        while = {
                            count = 40
                            create_army_transport = {
                                ship_name = "NAME_Prethoryn_Transport"
                                graphical_culture = "swarm_01"
                                army_name = "NAME_Prethoryn_Invaders"
                                army_type = "swarm_army"
                                species = event_target:prethoryn_species
                            }
                        }
                        set_location = {
                            target = PREV
                            distance = 10
                            angle = random
                        }
                    }
                }
            }
        }
    }
}
