ehofsa_redo = {
    potential = {
        hidden_trigger = {
            exists = from
            check_variable = {
                which = ehof_phase
                value <= 3
            }
            check_variable = {
                which = ehof_phase
                value > 0
            }
            is_discoverer = yes
        }
    }
    allow = {
        hidden_trigger = {
            check_variable = {
                which = ehof_last_target
                value > 0
            }
            has_country_flag = ehof_can_activate
            NOR = {
                has_country_flag = ehof_is_upgrading
                has_country_flag = ehof_can_deactivate
            }
        }
        if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 1
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "ehof_category_01"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 2
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "ehof_category_00"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 3
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "ehof_category_06"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 4
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "ehof_category_07"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 5
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_f"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 6
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_g"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 7
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_k"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 8
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_m"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 9
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_d"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 10
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_t"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 11
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_b"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 12
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_a"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 13
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_o"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 14
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_p_purple"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 15
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_lbv_blue"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 16
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_tt_red"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 17
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_w_azure"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 18
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_m_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 19
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_k_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 20
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_g_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 21
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_o_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 22
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_b_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 23
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_a_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 24
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_f_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 25
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_g_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 26
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_k_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 27
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_m_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 28
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_o_hyper"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 29
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_m_hyper"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 30
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_neutron_star"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 31
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_pulsar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 32
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_black_hole"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 33
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_microquasar_1"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 34
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_collapsar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 35
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_magnetar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 36
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_protostar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 37
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_ae"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 38
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_s_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 39
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_c_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 40
                }
            }
            custom_tooltip = "ehof_redo_notready_tooltip"
            custom_tooltip = "sc_nova_1"
        }
        if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 4
                }
            }
            resource_stockpile_compare = {
                resource = sr_dark_matter
                value >= @ehof_target_p4
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 3
                }
            }
            resource_stockpile_compare = {
                resource = sr_dark_matter
                value >= @ehof_target_p3
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 2
                }
            }
            resource_stockpile_compare = {
                resource = energy
                value >= @ehof_target_p2
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 1
                }
            }
            resource_stockpile_compare = {
                resource = energy
                value >= @ehof_target_p1
            }
        }
    }
    effect = {
        if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 1
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "ehof_category_01"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 2
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "ehof_category_00"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 3
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "ehof_category_06"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 4
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "ehof_category_07"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 5
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_f"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 6
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_g"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 7
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_k"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 8
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_m"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 9
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_d"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 10
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_t"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 11
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_b"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 12
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_a"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 13
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_o"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 14
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_p_purple"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 15
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_lbv_blue"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 16
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_tt_red"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 17
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_w_azure"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 18
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_m_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 19
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_k_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 20
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_g_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 21
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_o_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 22
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_b_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 23
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_a_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 24
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_f_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 25
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_g_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 26
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_k_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 27
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_m_super"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 28
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_o_hyper"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 29
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_m_hyper"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 30
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_neutron_star"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 31
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_pulsar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 32
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_black_hole"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 33
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_microquasar_1"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 34
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_collapsar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 35
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_magnetar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 36
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_protostar"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 37
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_ae"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 38
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_s_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 39
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_c_giant"
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_last_target
                    value = 40
                }
            }
            custom_tooltip = "ehof_redo_prefix"
            custom_tooltip = "sc_nova_1"
        }
        if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 4
                }
            }
            add_resource = {
                sr_dark_matter = @ehof_target_neg_p4
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 3
                }
            }
            add_resource = {
                sr_dark_matter = @ehof_target_neg_p3
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 2
                }
            }
            add_resource = {
                energy = @ehof_target_neg_p2
            }
        }
        else_if = {
            limit = {
                check_variable = {
                    which = ehof_phase
                    value = 1
                }
            }
            add_resource = {
                energy = @ehof_target_neg_p1
            }
        }
        hidden_effect = {
            ehof_redo_button = yes
        }
    }
}
